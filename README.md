# Gridelle

このプロジェクトの目的は、エクセルやスプレッドシートのよく知られた外観と操作性をもつWebアプリケーションの提供です。

私はWebアプリ版のエクセルやスプレッドシートに対して
下記問題を抱えているために次の要件を掲げます。

- 問題：コード管理をgithubで行っているためPR時の差分やViewでの内容把握ができない
    - 要件：yaml ファイルをInputする
    - 要件：yaml フォーマットをエクセルやスプレッドシートのような外観と操作性を提供する
    - 要件：yaml ファイルをOutputにする

## 一時マニュアル（暫定）

後日正式なドキュメントを整備する前提で、現状把握用のメモを以下にまとめます。

### 操作概要
- **セル選択**: セルをクリックすると単一選択、ドラッグまたはShift+クリックで矩形範囲を拡張できます。
- **セル編集**: ダブルクリック、または選択状態でEnterを押すと編集モードに入ります。Shift+Enterで改行、Enterのみで編集を確定します。
- **選択解除**: Escapeキー、または「選択をクリア」ボタンで現在の選択と編集状態を解除します。
- **コピー & ペースト**: `Ctrl/Cmd+C`で選択セルをTSV形式でコピー、`Ctrl/Cmd+V`で貼り付け。貼り付け時は必要に応じて行・列が自動で増えます。
- **フィルハンドル**: 選択範囲右下のハンドルをドラッグすると下方向へパターンコピー（選択範囲の行列を繰り返し貼り付け）します。
- **行操作**: 行番号ボタンで行全体を選択、Shift+クリックで複数行を連続選択。「削除」ボタンで該当行を削除します。「行を追加」で末尾に空行を追加します。
- **列操作**: 列名横の矢印で左右へ並べ替え。テキスト入力後に「列を追加」で新しい列を挿入します。貼り付けやフィルで不足する列は `column_番号` が自動追加されます。
- **一括入力**: 「選択セルへ一括入力」に値を入れて「一括入力する」を押すと、選択範囲の全セルをまとめて更新します。
- **シート管理**: メニュー内のシートタブで切り替え、テキストボックスでシート名を変更（Enterまたはフォーカスアウトで確定）、「シートを追加」で新規シートを作成します。
- **通知**: 操作結果やエラーはテーブル編集カード内のメッセージとして表示され、YAMLモーダルでも同じ通知を共有します。
- **ヘルプ**: メニューの「ヘルプ」タブからバージョン情報とドキュメント・問い合わせ先へのリンクを確認できます。

### キーボードショートカット
- `Ctrl/Cmd+C`: 選択中のセル群をクリップボードへコピーします。
- `Ctrl/Cmd+V`: クリップボードから貼り付けます。空セルでも最左上セルを基準に配置します。
- `Enter`: 選択セルを編集モードに切り替え、編集中に押すと編集を確定します。
- `Shift+Enter`: 編集中のセルに改行を挿入し、編集モードを維持します。
- `Escape`: 編集中なら編集をキャンセルし、未編集時は選択範囲を解除します。
- `Shift+クリック`: アンカーセルからクリック位置までの矩形範囲を選択します。行番号でも同様に機能します。

### YAML入力 / 出力フロー
- 「YAML入力 / プレビュー」ボタンでモーダルを開きます。
- YAMLを反映: テキストエリアの内容を解析しテーブルへ反映します。失敗時はエラーメッセージを表示します。
- YAMLファイルを読み込む: `.yml`, `.yaml`, `.json`, `text/yaml` を読み込んでテーブルへ展開し、テキストエリアにも内容を同期します。
- YAMLをダウンロード: 現在のシート構成を `table.yaml` としてダウンロードします。
- YAMLをコピー: 現在のシート構成をクリップボードへコピーします。

### YAMLフォーマット（暫定仕様）
- ルートは配列で、各要素がワークブック内のシートを表します。ルートが配列でない場合はエラーになります。
- シート要素: `name` は任意（空または未指定なら `Sheet 1` などに自動命名）、`rows` は列名と値のペアを持つ行オブジェクトの配列です。
- 行の補正: 行がオブジェクトでない場合は `value_番号` を自動生成し値を文字列化します。すべての値は文字列として扱い、配列やオブジェクトはJSON文字列に変換されます。欠けている列は空文字で補完され、貼り付けやフィルで不足する列は `column_番号` が連番で追加されます。
- シリアライズ: シートが存在しない場合は `[]` を出力し、常に末尾に改行が入ります。シート名はトリム後に空なら自動命名されます。

### YAMLサンプル

#### 単一シート例

```yaml
- name: バックログ
    rows:
        - feature: テーブル編集
            owner: Alice
            status: READY
            effort: "3"
        - feature: YAML Export
            owner: Bob
            status: REVIEW
            effort: "5"
```

#### 複数シート例

```yaml
- name: バックログ
    rows:
        - feature: テーブル編集
            owner: Alice
            status: READY
            effort: "3"
- name: 完了済み
    rows:
        - feature: QAレビュー
            owner: George
            status: DONE
            effort: "4"
```

